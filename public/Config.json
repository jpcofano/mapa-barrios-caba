{
  "data": {
    "supportedTransforms": [
      { "type": "geo_transform" }
    ],
    "fields": {
      "geoDimension": {
        "name": "ID del polígono (GeoJSON)",
        "types": ["TEXT"],
        "required": true,
        "max": 1,
        "description": "Dimensión de texto que coincide con el ID del barrio en el GeoJSON (ej.: feature.properties.ID_BARRIO)."
      },
      "barrioNombre": {
        "name": "Nombre de barrio (opcional)",
        "types": ["TEXT"],
        "required": false,
        "max": 1,
        "description": "Nombre legible para tooltip/etiquetas (si no se provee, se mostrará solo el ID)."
      },
      "metricPrimary": {
        "name": "Métrica principal (color)",
        "types": ["NUMBER"],
        "required": true,
        "max": 1,
        "description": "Métrica usada para colorear las áreas (alcance, tasa, índice, etc.)."
      },
      "metricSecondary": {
        "name": "Métrica secundaria (opcional)",
        "types": ["NUMBER"],
        "required": false,
        "max": 1,
        "description": "Métrica adicional para tooltip/comparativo (no afecta el color)."
      },
      "segment": {
        "name": "Categoría/segmento (opcional)",
        "types": ["TEXT"],
        "required": false,
        "max": 1,
        "description": "Categoría para filtrar/sombrear (no afecta el color)."
      }
    }
  },
  "style": [
    {
      "id": "colorScale",
      "label": "Escala de color",
      "elements": [
        {
          "type": "select",
          "id": "scaleType",
          "label": "Tipo de escala",
          "options": [
            { "label": "Cuantiles (quantile)", "value": "quantile" },
            { "label": "Cuantización (quantize)", "value": "quantize" },
            { "label": "Lineal (continuous)", "value": "linear" }
          ],
          "defaultValue": "quantile"
        },
        {
          "type": "number",
          "id": "classes",
          "label": "Clases (para quantile/quantize)",
          "min": 3,
          "max": 9,
          "defaultValue": 5
        },
        { "type": "color", "id": "minColor", "label": "Color mínimo", "defaultValue": "#f7fbff" },
        { "type": "color", "id": "midColor", "label": "Color medio",  "defaultValue": "#6baed6" },
        { "type": "color", "id": "maxColor", "label": "Color máximo", "defaultValue": "#08306b" },
        { "type": "checkbox", "id": "reverse", "label": "Invertir paleta", "defaultValue": false }
      ]
    },
    {
      "id": "nullHandling",
      "label": "Valores nulos / cero",
      "elements": [
        { "type": "color", "id": "nullColor", "label": "Color para nulos", "defaultValue": "#d9d9d9" },
        { "type": "checkbox", "id": "zeroAsNull", "label": "Tratar 0 como nulo", "defaultValue": false },
        { "type": "checkbox", "id": "clipOutliers", "label": "Recortar outliers (p5–p95)", "defaultValue": false }
      ]
    },
    {
      "id": "fillStroke",
      "label": "Relleno y borde",
      "elements": [
        { "type": "opacity", "id": "fillOpacity", "label": "Opacidad de relleno", "defaultValue": 0.9 },
        { "type": "color", "id": "strokeColor", "label": "Color de borde", "defaultValue": "#ffffff" },
        { "type": "lineWeight", "id": "strokeWidth", "label": "Grosor de borde", "defaultValue": 1 }
      ]
    },
    {
      "id": "legend",
      "label": "Leyenda",
      "elements": [
        { "type": "checkbox", "id": "showLegend", "label": "Mostrar leyenda", "defaultValue": true },
        {
          "type": "select",
          "id": "legendPosition",
          "label": "Posición",
          "options": [
            { "label": "Auto", "value": "auto" },
            { "label": "Arriba", "value": "top" },
            { "label": "Derecha", "value": "right" },
            { "label": "Abajo", "value": "bottom" },
            { "label": "Izquierda", "value": "left" }
          ],
          "defaultValue": "auto"
        }
      ]
    },
    {
      "id": "tooltip",
      "label": "Tooltip",
      "elements": [
        { "type": "checkbox", "id": "showTooltip", "label": "Mostrar tooltip", "defaultValue": true },
        { "type": "checkbox", "id": "tooltipShowBarrio", "label": "Incluir 'Barrio'", "defaultValue": true },
        { "type": "checkbox", "id": "tooltipShowMetric", "label": "Incluir métrica principal", "defaultValue": true },
        {
          "type": "select",
          "id": "valueFormat",
          "label": "Formato del valor",
          "options": [
            { "label": "Automático", "value": "auto" },
            { "label": "Entero", "value": "integer" },
            { "label": "Dos decimales", "value": "2d" },
            { "label": "Porcentaje", "value": "percent" },
            { "label": "Abreviado (K/M)", "value": "compact" }
          ],
          "defaultValue": "auto"
        }
      ]
    }
  ],
  "features": {
    "beta": false
  }
}
