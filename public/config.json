{
  "data": [
    {
      "id": "main",
      "label": "Datos",
      "elements": [
        {
          "id": "geoDimension",
          "label": "Dimensión geográfica (Barrio/Comuna)",
          "type": "DIMENSION",
          "options": { "min": 1, "max": 1 }
        },
        {
          "id": "param_nivel",
          "label": "Parámetro Nivel (Barrio/Comuna)",
          "type": "DIMENSION",
          "options": { "min": 0, "max": 1 }
        },
        {
          "id": "metricPrimary",
          "label": "Métrica principal (para colorear)",
          "type": "METRIC",
          "options": { "min": 1, "max": 1 }
        },
        {
          "id": "metricExtras",
          "label": "Métricas adicionales (para tooltip/popup)",
          "type": "METRIC",
          "options": { "min": 0, "max": 10 }
        },
        {
          "id": "extraText",
          "label": "Campos extra (texto para tooltip)",
          "type": "DIMENSION",
          "options": { "min": 0, "max": 10 }
        }
      ]
    }
  ],

  "style": [
    {
      "id": "geography",
      "label": "Geografía",
      "elements": [
        {
          "id": "nivelJerarquia",
          "label": "Nivel (si no hay parámetro)",
          "type": "SELECT_SINGLE",
          "options": [
            { "label": "Barrio", "value": "barrio" },
            { "label": "Comuna", "value": "comuna" }
          ],
          "defaultValue": "barrio"
        },
        {
          "id": "geojsonProperty",
          "label": "Propiedad alternativa del GeoJSON (opcional)",
          "type": "INPUT_TEXT",
          "defaultValue": ""
        }
      ]
    },

    {
      "id": "colors",
      "label": "Colores y escala",
      "elements": [
        {
          "id": "palettePreset",
          "label": "Paleta",
          "type": "SELECT_SINGLE",
          "options": [
            { "label": "Viridis",         "value": "viridis" },
            { "label": "Magma",           "value": "magma" },
            { "label": "Plasma",          "value": "plasma" },
            { "label": "Cividis",         "value": "cividis" },
            { "label": "Turbo",           "value": "turbo" },
            { "label": "Spectral",        "value": "Spectral" },
            { "label": "Solo amarillo",   "value": "soloAmarillo" },
            { "label": "Cool → Amarillo", "value": "coolToYellow" },
            { "label": "BA Warm",         "value": "baWarm" },
            { "label": "BA Cool",         "value": "baCool" }
          ],
          "defaultValue": "viridis"
        },
        {
          "id": "invertScale",
          "label": "Invertir escala",
          "type": "CHECKBOX",
          "defaultValue": false
        },
        {
          "id": "noDataColor",
          "label": "Color “Sin datos”",
          "type": "FILL_COLOR",
          "defaultValue": "#d9d9d9"
        },
        {
          "id": "opacity",
          "label": "Opacidad del relleno",
          "type": "INPUT_NUMBER",
          "defaultValue": 0.75
        }
      ]
    },

    {
      "id": "borders",
      "label": "Bordes",
      "elements": [
        {
          "id": "showBorders",
          "label": "Mostrar bordes",
          "type": "CHECKBOX",
          "defaultValue": true
        },
        {
          "id": "borderColor",
          "label": "Color de borde (\"auto\" para contraste)",
          "type": "INPUT_TEXT",
          "defaultValue": "auto"
        },
        {
          "id": "borderWidth",
          "label": "Grosor del borde",
          "type": "INPUT_NUMBER",
          "defaultValue": 1
        },
        {
          "id": "borderOpacity",
          "label": "Opacidad del borde",
          "type": "INPUT_NUMBER",
          "defaultValue": 0.7
        }
      ]
    },

    {
      "id": "legend",
      "label": "Leyenda",
      "elements": [
        {
          "id": "showLegend",
          "label": "Mostrar leyenda",
          "type": "CHECKBOX",
          "defaultValue": true
        },
        {
          "id": "legendPosition",
          "label": "Posición",
          "type": "SELECT_SINGLE",
          "options": [
            { "label": "Abajo derecha",  "value": "bottomright" },
            { "label": "Abajo izquierda","value": "bottomleft" },
            { "label": "Arriba derecha", "value": "topright" },
            { "label": "Arriba izquierda","value": "topleft" }
          ],
          "defaultValue": "bottomright"
        },
        {
          "id": "legendNoDecimals",
          "label": "Ocultar decimales",
          "type": "CHECKBOX",
          "defaultValue": true
        },
        {
          "id": "legendNoDataText",
          "label": "Texto “Sin datos”",
          "type": "INPUT_TEXT",
          "defaultValue": "Sin datos"
        }
      ]
    },
    {
      "id": "labels",
      "label": "Etiquetas / Popup",
      "elements": [
        {
          "id": "showLabels",
          "label": "Mostrar tooltip (hover)",
          "type": "CHECKBOX",
          "defaultValue": true
        },
        {
          "id": "tooltipFormat",
          "label": "Formato Tooltip (plantilla)",
          "type": "INPUT_TEXT",
          "defaultValue": "<strong>{{nombre}}</strong><br/>Valor: {{valor}}"
        },
        {
          "id": "popupFormat",
          "label": "Formato Popup (plantilla)",
          "type": "INPUT_TEXT",
          "defaultValue": "<strong>{{nombre}}</strong><br/>Valor: {{valor}}"
        }
      ]
    },

    {
      "id": "categories",
      "label": "Modo por categorías (1–3)",
      "elements": [
        { "id": "categoryMode",       "label": "Activar modo por categorías", "type": "CHECKBOX",    "defaultValue": false },
        { "id": "cat1Value",          "label": "Valor categoría 1",           "type": "INPUT_NUMBER","defaultValue": 1 },
        { "id": "cat1Color",          "label": "Color categoría 1",           "type": "FILL_COLOR",  "defaultValue": "#f3c300" },
        { "id": "cat1Label",          "label": "Etiqueta cat. 1",             "type": "INPUT_TEXT",  "defaultValue": "Categoría 1" },
        { "id": "cat2Value",          "label": "Valor categoría 2",           "type": "INPUT_NUMBER","defaultValue": 2 },
        { "id": "cat2Color",          "label": "Color categoría 2",           "type": "FILL_COLOR",  "defaultValue": "#4e79a7" },
        { "id": "cat2Label",          "label": "Etiqueta cat. 2",             "type": "INPUT_TEXT",  "defaultValue": "Categoría 2" },
        { "id": "cat3Value",          "label": "Valor categoría 3",           "type": "INPUT_NUMBER","defaultValue": 3 },
        { "id": "cat3Color",          "label": "Color categoría 3",           "type": "FILL_COLOR",  "defaultValue": "#59a14f" },
        { "id": "cat3Label",          "label": "Etiqueta cat. 3",             "type": "INPUT_TEXT",  "defaultValue": "Categoría 3" },
        { "id": "categoryOtherColor", "label": "Color \"Otros\"",              "type": "FILL_COLOR",  "defaultValue": "#cccccc" }
      ]
    },

    {
      "id": "branding",
      "label": "Branding (opcional)",
      "elements": [
        { "id": "logoEnabled",  "label": "Mostrar logo",                "type": "CHECKBOX",     "defaultValue": false },
        { "id": "logoDataUrl",  "label": "Logo embebido (data: URL)",   "type": "INPUT_TEXT",   "defaultValue": "" },
        { "id": "logoWidthPx",  "label": "Ancho del logo (px)",         "type": "INPUT_NUMBER", "defaultValue": 128 },
        { "id": "logoOpacity",  "label": "Opacidad del logo",           "type": "INPUT_NUMBER", "defaultValue": 1 },
        {
          "id": "logoPosition",
          "label": "Posición del logo",
          "type": "SELECT_SINGLE",
          "options": [
            { "label": "Arriba izq.", "value": "topleft" },
            { "label": "Arriba der.", "value": "topright" },
            { "label": "Abajo izq.",  "value": "bottomleft" },
            { "label": "Abajo der.",  "value": "bottomright" }
          ],
          "defaultValue": "bottomright"
        }
      ]
    }
  ],

  "supports": {
    "interactions": ["FILTER"]
  }
}
